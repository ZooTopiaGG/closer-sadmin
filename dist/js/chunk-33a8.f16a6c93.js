(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33a8"],{"1f08":function(t,e,a){"use strict";var i=a("cf4b"),s=a.n(i);s.a},cf4b:function(t,e,a){},edfa:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"flex flex-v",attrs:{id:"permission"}},[i("section",{staticClass:"permission_title"},[t._v("活动管理")]),i("section",{staticClass:"permission_table"},[i("section",{staticClass:"permission_table_content"},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.activityLists.data}},[i("el-table-column",{attrs:{prop:"activityName",label:"活动名称"}}),i("el-table-column",{attrs:{prop:"size",label:"尺寸（px）"}}),i("el-table-column",{attrs:{prop:"url",width:"280",label:"关联页面"}}),i("el-table-column",{attrs:{label:"展示图"},scopedSlots:t._u([{key:"default",fn:function(t){return[i("section",[i("img",{staticClass:"table_logo",attrs:{src:t.row.logo,alt:""}})])]}}])}),i("el-table-column",{attrs:{prop:"status",label:"展示状态"}}),i("el-table-column",{attrs:{prop:"buildVer",label:"版本号"}}),i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"280"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===t.authUser.type?i("section",[i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){t.edit(e.row)}}},[t._v("编辑")]),i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){t.start(e.row)}}},["已停用"===e.row.status?i("span",[t._v("启用")]):i("span",[t._v("停用")])]),i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){t.look(e.row)}}},[t._v("查看")])],1):i("section",[t.authUser.permissions&&t.authUser.permissions.activity&&"activity_update"===t.authUser.permissions.activity[0].permissions?i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){t.edit(e.row)}}},[t._v("编辑")]):t._e(),t.authUser.permissions&&t.authUser.permissions.activity&&"activity_update"===t.authUser.permissions.activity[0].permissions?i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){t.start(e.row)}}},["已停用"===e.row.status?i("span",[t._v("启用")]):i("span",[t._v("停用")])]):t._e(),t.authUser.permissions&&t.authUser.permissions.activity&&"activity_view"===t.authUser.permissions.activity[0].permissions?i("el-button",{attrs:{type:"text",size:"medium"},on:{click:function(a){t.look(e.row)}}},[t._v("查看")]):t._e()],1)]}}])})],1)],1),i("el-dialog",{staticStyle:{"text-align":"center"},attrs:{title:"查看位置",visible:t.outerVisible1},on:{"update:visible":function(e){t.outerVisible1=e}}},[i("img",{attrs:{src:a("fc50"),alt:""}})]),i("el-dialog",{attrs:{title:"编辑活动",visible:t.outerVisible},on:{"update:visible":function(e){t.outerVisible=e}}},[i("section",{staticClass:"dialog-content"},[i("el-form",{staticClass:"city-ruleform",attrs:{rules:t.rules,"label-width":"140px",disabled:t.isdisabled}},[i("el-form-item",{attrs:{label:"活动名称："}},[i("section",{staticClass:"flex flex-align-center dialog-label"},[i("el-input",{attrs:{placeholder:"输入活动名称"},model:{value:t.displayname,callback:function(e){t.displayname=e},expression:"displayname"}})],1)]),i("el-form-item",{attrs:{label:"建议尺寸（px）："}},[i("section",{staticClass:"flex flex-align-center dialog-label"},[i("span",[t._v(t._s(t.displaysize))])])]),i("el-form-item",{attrs:{label:"关联页面："}},[i("section",{staticClass:"flex flex-align-center"},[i("el-input",{attrs:{type:"url",placeholder:"输入链接"},model:{value:t.displaypage,callback:function(e){t.displaypage=e},expression:"displaypage"}})],1)]),i("el-form-item",{directives:[{name:"loading",rawName:"v-loading.body",value:t.loadingAvatarUpload,expression:"loadingAvatarUpload",modifiers:{body:!0}}],attrs:{label:"展示图："}},[i("section",{staticClass:"activity-cell flex flex-align-start"},[i("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,"show-file-list":!1,"on-error":t.handleError,headers:t.headers,"on-success":t.handleAvatarSuccess,"before-upload":t.beforeAvatarUpload}},[t.imageUrl?i("img",{staticClass:"avatar",attrs:{src:t.imageUrl}}):i("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)]),i("el-form-item",{attrs:{label:"版本号："}},[i("section",{staticClass:"flex flex-align-center dialog-label"},[i("el-input",{attrs:{disabled:t.verDisabled,placeholder:"待审版本号"},model:{value:t.buildVer,callback:function(e){t.buildVer=e},expression:"buildVer"}})],1)]),i("el-form-item",{attrs:{label:"展示位状态："}},[i("section",{staticClass:"flex flex-align-center dialog-label"},[i("el-input",{attrs:{disabled:!0},model:{value:t.displaystatus,callback:function(e){t.displaystatus=e},expression:"displaystatus"}})],1)])],1)],1),i("section",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保 存")])],1)])],1)])},s=[],r=(a("96cf"),a("3040")),n=a("c93e"),l=a("2f62"),o={computed:Object(n["a"])({},Object(l["c"])("activity",["activityLists"]),{headers:function(){return{Authorization:"CloserSysAuth ".concat(this.$store.state.token)}},authUser:function(){return this.$store.state.authUser}}),data:function(){return{isdisabled:!1,verDisabled:!1,rules:{},loadingAvatarUpload:!1,outerVisible:!1,outerVisible1:!1,uploadUrl:"".concat(api.filePath).concat(api.file),imageUrl:"",imageOnlineUrl:"",operationtype:"",row:{},display:{options:[{value:"停用",label:"启用"}]},displayname:"",buildVer:"",displaystatus:"",displaypage:"",displaysize:"246 * 246"}},created:function(){this.getAllActivity({pagenum:1,pagesize:10})},methods:Object(n["a"])({},Object(l["b"])("activity",["getAllActivity","updateActivity","updateActivityStatus"]),{handleError:function(t){this.$message.error("Network Error!"),this.loadingAvatarUpload=!1},handleAvatarSuccess:function(t,e){var a=this;try{0===t.code?(a.$message.success("上传成功"),a.imageUrl=URL.createObjectURL(e.raw),a.imageUrl="".concat(api.filePath).concat(t.result.url)):a.$message.error(t.result)}catch(t){a.$message.error(t)}a.loadingAvatarUpload=!1},beforeAvatarUpload:function(t){var e=this;e.loadingAvatarUpload=!0;var a=t.type.indexOf("image/")>-1,i=t.size/1024/1024<.75;return a||(e.$message.error("只能上传图片!"),e.loadingAvatarUpload=!1),i||(e.loadingAvatarUpload=!1,e.$message.error("上传图片大小不能超过 750kb!")),a&&i},save:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=this,e.displayname){t.next=4;break}return e.$message.warning("活动名称不能为空！"),t.abrupt("return");case 4:if(e.displaypage){t.next=7;break}return e.$message.warning("活动页面不能为空！"),t.abrupt("return");case 7:if(e.$com.isUrl(e.displaypage)){t.next=10;break}return e.$message.warning("活动页面地址错误！"),t.abrupt("return");case 10:if(e.imageUrl){t.next=13;break}return e.$message.warning("活动logo不能为空！"),t.abrupt("return");case 13:if(e.buildVer){t.next=16;break}return e.$message.warning("版本号不能为空！"),t.abrupt("return");case 16:return t.next=18,e.updateActivity({activityId:e.row.activityId,name:e.displayname,buildVer:e.buildVer,size:e.displaysize,logo:e.imageUrl,url:e.displaypage});case 18:if(a=t.sent,!a){t.next=23;break}return e.outerVisible=!1,t.next=23,e.activityList();case 23:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),look:function(){this.outerVisible1=!0},edit:function(t){var e=this;e.row=t,e.outerVisible=!0,e.displayname=t.activityName,e.buildVer=t.buildVer,e.displaystatus=t.status,e.displaypage=t.url,e.imageUrl=t.logo,e.verDisabled="已停用"===t.status},activityList:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e=this,t.next=3,e.getAllActivity({pagenum:1,pagesize:10});case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),sureStart:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=this,i="已停用"!==e.status,t.next=3,a.updateActivityStatus({activityId:e.activityId,enabled:i});case 3:if(s=t.sent,!s){t.next=7;break}return t.next=7,a.activityList();case 7:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),start:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(e){var a,i,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a=this,console.log(e),i="已启用"===e.status?"此操作将关闭“".concat(e.activityName,"”, 是否继续?"):"此操作将开启“".concat(e.activityName,"”, 是否继续?"),a.$confirm(i,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,a.sureStart(e);case 2:case"end":return t.stop()}},t,this)}))).catch(function(){s.$message({type:"info",message:"已取消操作"})});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()})},c=o,u=(a("1f08"),a("2877")),p=Object(u["a"])(c,i,s,!1,null,"14157720",null);p.options.__file="index.vue";e["default"]=p.exports},fc50:function(t,e,a){t.exports=a.p+"img/displaylogo.0e2d255c.png"}}]);
//# sourceMappingURL=chunk-33a8.f16a6c93.js.map